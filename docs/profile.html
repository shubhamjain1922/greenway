<!DOCTYPE html>
<html>
<head>
    <title>GreenWay</title>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500&display=swap" rel="stylesheet"/>
    <script src="https://kit.fontawesome.com/64d58efce2.js" crossorigin="anonymous"></script>

    <style>
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: 'Poppins',sans-serif;
    }

    .menuItem {
        display: block;
        margin: 15px 20px;
        font-size: 27px;
        color: white;
        text-decoration: none;
    }

    .menuItem:hover {
        text-decoration: underline;
    }

    .hamburger {
        position: absolute;
        z-index: 100;
        top: 15px;
        left: 15px;
        padding: 4px;
        border: black solid 1px;
        background: white;
        cursor: pointer;
    }

    .closeIcon {
        display: none;
    }

    .menu {
        position: fixed;
        transform: translateY(-100%);
        transition: transform 0.2s;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        z-index: 99;
        background: black;
        color: white;
        list-style: none;
        padding-top: 4rem;
    }

    .showMenu {
        transform: translateY(0);
    }
    .logitem {
        position: absolute;
        bottom: 10px;
    }

    .navcon {
        height: 200px;
        width: 100%;
        background: #189c18;
        padding: 20px;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 20px;
    }
    .head {
        font-size: 45px;
        font-weight: bold;
        color: white;
        margin-top: 15px;
        margin-bottom: 0px;
    }

    .info {
        float: left;
    }
    .ic {
        align-items: center;
        font-size: 150px;
        text-align: center;
        margin-right: 10px;
        float: left;
        color: white;
    }
    .heade {
        text-align: center;
        font-size: 20px;
        font-weight: bold;
        color: white;
        margin-top: 5px;
    }

    .addic {
        align-items: center;
        font-size: 50px;
        text-align: center;
        margin-right: 10px;
        color: white;
        position: absolute;
        right: 50px;
        cursor: pointer;
    }

    @media (max-width: 700px) {
        .navcon {
            height: 150px;
        }
        .addic {
            font-size: 30px;
            right: 15px;
        }

        .ic {
            font-size: 100px;
        }

        .head {
            font-size: 35px;
        }

        .heade {
            font-size: 15px;
        }
    }

    .wrap {
        background: #141514;
        min-height: 450px;
        width: 400px;
        margin: auto;
        padding: 20px;
    }

    .tile {
        background: #e1e6e1;
        height: 60px;
        width: 100%;
        margin-bottom: 10px;
        border-radius: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 17px;
        font-weight: 500;
    }

    .comm {
        color: white;
        text-align: center;
    }

    .popcon {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        color: white;
        position: absolute;
        top: 0;
        left: 0;
        height: 100vh;
        width: 100vw;
        z-index: 1000;
        background: rgba(0, 0, 0, 0.5);
        visibility: hidden;
    }

    .popdiv {
        height: 280px;
        width: 300px;
        border-radius: 5px;
        padding: 15px;
        background: white;
        display: flex;
        align-items: center;
        justify-content: flex-start;
        flex-direction: column;
        color: #141514;
        position: relative;
    }

    .addbut {
        background: #189c18;
        padding: 10px 20px;
        width: 80%;
        color: white;
        border-radius: 5px;
        text-align: center;
        font-size: 20px;
        margin-top: 15px;
        cursor: pointer;
    }

    .inp {
        width: 90%;
        border-radius: 5px;
        padding: 10px;
        background: #141514;
        margin-top: 20px;
        color: white;
        cursor: pointer;
    }

    .closeic {
        color: black;
        position: absolute;
        top: 5px;
        right: 5px;
        cursor: pointer;
    }

</style>
</head>
<body>
    <nav class="navcon">
        <ul class="menu">
            <li><a class="menuItem" href="home.html"><i class="fas fa-home"></i> Home</a></li>
            <li><a class="menuItem" href="profile.html"><i class="fas fa-user-circle"></i> Profile</a></li>
            <li><a class="menuItem logitem" href="#" onclick="logoutfuc()">Logout <i class="fas fa-sign-out-alt"></i></a></li>
        </ul>
        <button class="hamburger">
            <i class="menuIcon material-icons">menu</i>
            <i class="closeIcon material-icons">close</i>
        </button>
        <div class="header">
            <i class="fas fa-user-circle ic"></i>
            <div class="info">
                <p class="head username"></p>
                <span class="heade email"></span>
            </div>
        </div>
        <i class="fas fa-plus-square addic"></i>
    </nav>

    <div class="wrap">
        <p class="comm">Add a vehicle</p>
    </div>

    <div class="popcon">
        <div class="popdiv">
            <i class="fas fa-times closeic"></i>
            <h1>Add vehicle</h1>
            <select name="model" id="model" class="inp">
                <option value="" selected disabled hidden>Select brand</option>
            </select>
            <select name="make" id="make" class="inp">
                <option value="" selected disabled hidden>Select model</option>
            </select>
            <div class="addbut">Add</div>
        </div>
    </div>
    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="vehicles.json"></script>
    <script>
        var models=Object.keys(vehicle);
        var make;
        for(i=0;i<models.length;i++){
            $("#model").append('<option value="'+models[i]+'">'+models[i]+'</option>')
        }
        $('#model').on('change', function() {
            modelname=$("#model").val();
            make=Object.keys(vehicle[modelname]);
            $("#make").empty();
            for(i=0;i<make.length;i++){
                $("#make").append('<option value="'+make[i]+'">'+make[i]+'</option>')
            }
        });
        $(".addbut").click(async function(){
             body = {
                "username":sessionStorage.getItem("username"),
                "vid":vehicle[modelname][$("#make").val()],
                "make":$("#model").val(),
                "model":$("#make").val()
            }
            var res=await axios.post("https://greenway.azurewebsites.net/addvehicle",body).catch(function (error) {
                alert(error.response.data.message);
            })
            window.location.href="profile.html";
        })
        $(document).ready(function (){
            var name=sessionStorage.getItem("username");
            if(name==null)
                window.location.href="login.html";
            getinfo(name);
        })
        async function getinfo(name) {
            body = {
                "username":name
            }
            var res=await axios.post("https://greenway.azurewebsites.net/userinfo",body).catch(function (error) {
                alert(error.response.data.message);
            })
            $(".username").html(res.data.data.username);
            $(".email").html(res.data.data.mail);
            var veh=res.data.data.vehicles;
            for(i=0;i<veh.length;i++){
                $(".comm").css({"display":"none"})
                $(".wrap").append('<div class="tile">'+veh[i].make+' - '+veh[i].model+'</div>');
            }
        }
        function logoutfuc() {
            sessionStorage.removeItem("username")
            window.location.href="login.html";
        }

        $(".addic").click(function(){
            $(".popcon").css({"visibility":"visible"});
        })
        $(".closeic").click(function(){
            $(".popcon").css({"visibility":"hidden"});
        })
        const menu = document.querySelector(".menu");
        const menuItems = document.querySelectorAll(".menuItem");
        const hamburger= document.querySelector(".hamburger");
        const closeIcon= document.querySelector(".closeIcon");
        const menuIcon = document.querySelector(".menuIcon");
        function toggleMenu() {
          if (menu.classList.contains("showMenu")) {
            menu.classList.remove("showMenu");
            closeIcon.style.display = "none";
            menuIcon.style.display = "block";
        } else {
            menu.classList.add("showMenu");
            closeIcon.style.display = "block";
            menuIcon.style.display = "none";
        }
    }

    hamburger.addEventListener("click", toggleMenu);

    menuItems.forEach( 
        function(menuItem) { 
            menuItem.addEventListener("click", toggleMenu);
        }
        )
    </script>
</body>
</html>
